{"mappings":";;;AAYe,kDAAgB,gBAC7B,eAAe,CAAA,GAAA,mBAAY,UAC3B,QAAQ,qCACR,cAAc,4BACd,wBAAwB,WACxB,OAAO,SACP,KAAK,UACL,MAAM,UACN,SAAS,WAAW,MAAM,EACd,GAAG,CAAC,CAAC;IACjB,OAAO,MAAM;QACX,OAAO,WAAW,WAAW,YAAY,OAAO,SAAS,MAAM;QAC/D,OAAO,WACL,YAAY,SAAS,OAAO,MAAM,CAAC,IAAI,CAAC,QAAQ,QAAQ,IAAO,CAAA,CAAC,CAAA,EAAG;QACrE,MAAO;YACL,IAAI,SAAS,IAAI,CAAC,QAAQ;YAC1B,YAAY,CAAC,OAAO,GAAG;YACvB,IAAI,SAAS,IAAI,CAAC,QAAQ;YAC1B,KAAK,IAAI,kBAAkB;gBAAC;gBAAQ;gBAAU;aAAoB,CAAE;gBAClE,IAAI,CAAE,CAAA,kBAAkB,MAAK,GAC3B;gBAEF,MAAM,CAAC,eAAe,GACpB,UAAU,aAAa,YAAY,YAC/B,AAAC,CAAA,CAAC,QACA,IAAI,MAAM,MAAM,CAAC,eAAe,EAAE;wBAChC,OAAM,MAAM,EAAE,OAAO,EAAE,QAAQ;4BAC7B,YAAY,KAAK,CAAC,QAAQ,CAAC,EAAE;4BAC7B,OAAO,MAAM,QAAQ,SAAS;wBAChC;oBACF,EAAC,EAAG,QAAQ,KAAK,CAAC,IAAI,CAAC,YACzB,AAAC,CAAA,CAAC,KAAK,GAAG,GAAG;oBACX,YAAY,KAAK,CAAC;oBAClB,OAAO,IAAI,MAAM;gBACnB,CAAA,EAAG,IAAI,CAAC,MAAM,MAAM,CAAC,eAAe,CAAC,IAAI,CAAC;YAClD;QACF,CAAC;QACD,OAAO,MAAM,MAAW,EAAwB;YAC9C,IAAI,4BAA4B,gBAAgB;gBAC9C,MAAM,OAAO,yBAAyB,QAAQ,IAAI,CAAC,QAAQ;gBAC3D,IAAI,MAAM,OAAO,KAAK,KAAK;gBAC3B,MAAM,QAAQ,YAAY,QAAQ;gBAClC,eAAe,QAAQ,IAAI,CAAC,QAAQ,EAAE;2BACpC;oBACA,YAAY;oBACZ,UAAU;oBACV,cAAc;gBAChB;gBACA,OAAO;YACT;YACA,IAAI,kBAAkB,CAAE,CAAA,IAAI,CAAC,QAAQ,IAAI,MAAK,GAC5C,eAAe,QAAQ,IAAI,CAAC,QAAQ,EAAE;gBACpC,OAAO,YAAY,QAAQ;gBAC3B,YAAY;gBACZ,UAAU;gBACV,cAAc;YAChB;YACF,OAAQ,MAAM,CAAC,IAAI,CAAC,QAAQ,CAAC,KAAK,YAAY,QAAQ;QACxD;QACA,GAAW;QACX,aAAc;YACZ,IAAI,CAAC,EAAE,GAAG,KAAK,MAAM,KAAK;QAC5B;QACA,OAAO,MAAM,EAAE;YACb,OAAO,YAAY,KAAK,CAAC,OAAO,CAAC,IAAI,CAAC,EAAE,CAAC;QAC3C;QACA,IAAI,MAAM,EAAE;YACV,OAAO,IAAI,CAAC,EAAE,IAAI,YAAY,KAAK,CAAC;QACtC;QACA,IAAI,MAAM,EAAE;YACV,OAAO,YAAY,KAAK,CAAC,OAAO,CAAC,IAAI,CAAC,EAAE,CAAC;QAC3C;QACA,IAAI,MAAM,EAAE,KAAK,EAAE;YACjB,YAAY,KAAK,CAAC,OAAO,CAAC,IAAI,CAAC,EAAE,CAAC,GAAG;QACvC;IACF;AACF","sources":["weak-map/factory/index.ts"],"sourcesContent":["import { polyfillKeys as _polyfillKeys } from \"@portal-solutions/semble-common\";\ntype _Reflect = typeof Reflect;\nexport type FactoryOpts = {\n  polyfillKeys?: typeof _polyfillKeys;\n  symId?: string;\n  Symbol?: undefined | typeof globalThis.Symbol;\n  Proxy?: undefined | typeof globalThis.Proxy;\n  Reflect?: undefined | _Reflect;\n  defineProperty?: undefined | typeof Object.defineProperty;\n  getOwnPropertyDescriptor?: undefined | typeof Object.getOwnPropertyDescriptor;\n  Object?: typeof globalThis.Object;\n};\nexport default function create({\n  polyfillKeys = _polyfillKeys,\n  symId = \"__sembleWeakMap__\",\n  defineProperty = undefined,\n  getOwnPropertyDescriptor = undefined,\n  Reflect = undefined,\n  Proxy = undefined,\n  Symbol = undefined,\n  Object = globalThis.Object,\n}: FactoryOpts = {}): typeof WeakMap {\n  return class WeakMapTemp {\n    static __symbol = Symbol !== undefined ? Symbol(symId) : symId;\n    static __create =\n      \"create\" in Object ? Object.create.bind(Object, null) : () => ({});\n    static {\n      let symbol = this.__symbol;\n      polyfillKeys[symbol] = true;\n      let create = this.__create;\n      for (var objectProperty of [\"seal\", \"freeze\", \"preventExtensions\"]) {\n        if (!(objectProperty in Object)) {\n          continue;\n        }\n        Object[objectProperty] =\n          Proxy !== undefined && Reflect !== undefined\n            ? ((apply) =>\n                new Proxy(Object[objectProperty], {\n                  apply(target, thisArg, argArray) {\n                    WeakMapTemp.__get(argArray[0]);\n                    return apply(target, thisArg, argArray);\n                  },\n                }))(Reflect.apply.bind(Reflect))\n            : ((old, b, ...args) => {\n                WeakMapTemp.__get(b);\n                return old(b, ...args);\n              }).bind(null, Object[objectProperty].bind(Object));\n      }\n    }\n    static __get(target: any): { [a: string]: any } {\n      if (getOwnPropertyDescriptor && defineProperty) {\n        const desc = getOwnPropertyDescriptor(target, this.__symbol);\n        if (desc) return desc.value;\n        const value = WeakMapTemp.__create();\n        defineProperty(target, this.__symbol, {\n          value,\n          enumerable: false,\n          writable: true,\n          configurable: false,\n        });\n        return value;\n      }\n      if (defineProperty && !(this.__symbol in target))\n        defineProperty(target, this.__symbol, {\n          value: WeakMapTemp.__create(),\n          enumerable: false,\n          writable: true,\n          configurable: false,\n        });\n      return (target[this.__symbol] ??= WeakMapTemp.__create());\n    }\n    id: string;\n    constructor() {\n      this.id = Math.random() + \"\";\n    }\n    delete(object) {\n      delete WeakMapTemp.__get(object)[this.id];\n    }\n    has(object) {\n      return this.id in WeakMapTemp.__get(object);\n    }\n    get(object) {\n      return WeakMapTemp.__get(object)[this.id];\n    }\n    set(object, value) {\n      WeakMapTemp.__get(object)[this.id] = value;\n    }\n  } as any;\n}\n"],"names":[],"version":3,"file":"index.js.map"}